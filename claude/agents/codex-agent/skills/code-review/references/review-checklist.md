# 代码审核检查清单

## 1. 越界检查（必须）

- [ ] 所有变更文件在 `allowed_paths` 范围内
- [ ] 没有文件命中 `forbidden_patterns`
- [ ] 没有修改不属于本提案的文件

## 2. 代码质量检查

### 2.1 结构问题（"屎山代码"）

- [ ] **超长函数**：单个函数不超过100行
- [ ] **超长文件**：单个文件不超过500行
- [ ] **深层嵌套**：嵌套不超过4层（if/for/while等）
- [ ] **重复代码**：没有相似代码块出现3次以上
- [ ] **上帝类/函数**：没有单个类/函数承担过多职责
- [ ] **过长参数列表**：函数参数不超过5个
- [ ] **魔法数字**：没有硬编码的数字（应使用常量）

### 2.2 可读性问题

- [ ] **命名清晰**：变量/函数/类命名能表达意图
- [ ] **注释充分**：复杂逻辑有注释说明
- [ ] **注释语言**：注释使用中文（按项目规范）
- [ ] **代码风格**：缩进、空格、换行一致

### 2.3 设计问题

- [ ] **单一职责**：每个模块/类/函数只做一件事
- [ ] **依赖清晰**：模块间依赖关系清晰，无循环依赖
- [ ] **接口合理**：公开接口设计合理，易于使用

## 3. 规范检查

### 3.1 通用规范

- [ ] **注释符号**：注释符号后不跟空格（`//注释`）
- [ ] **模块化**：按职责拆分模块，避免单文件堆叠
- [ ] **错误处理**：错误信息用中文

### 3.2 Rust 特定规范

- [ ] **完整路径**：使用完整路径，不用 `use`（宏/trait例外）
- [ ] **错误处理**：使用 `Result` 而非 `panic!`
- [ ] **所有权**：正确处理所有权和借用

### 3.3 Python 特定规范

- [ ] **类型注解**：关键函数有类型注解
- [ ] **异常处理**：不使用裸 `except:`

### 3.4 C 特定规范

- [ ] **内存管理**：malloc/free 配对
- [ ] **缓冲区安全**：使用安全的字符串函数

## 4. 安全检查

### 4.1 高风险（必须修复）

- [ ] **硬编码敏感信息**：没有硬编码密码、密钥、token
- [ ] **SQL注入**：没有字符串拼接SQL
- [ ] **命令注入**：没有未转义的shell命令
- [ ] **路径遍历**：没有未验证的文件路径操作
- [ ] **XSS风险**：没有未转义的用户输入输出到HTML

### 4.2 中风险（建议修复）

- [ ] **未处理错误**：没有忽略错误返回值
- [ ] **资源泄漏**：文件/连接正确关闭
- [ ] **空指针风险**：正确检查null/None
- [ ] **并发问题**：没有明显的竞态条件

## 5. 性能检查

- [ ] **算法复杂度**：没有明显的O(n²)或更差的算法（在可避免的情况下）
- [ ] **资源使用**：没有不必要的大内存分配
- [ ] **I/O效率**：没有不必要的重复I/O操作

## 6. 验收口径检查

- [ ] 提案中的所有验收条件都已满足
- [ ] 预期产出文件都已生成
- [ ] 功能按需求实现

## 检查结果汇总

| 类别 | 高风险 | 中风险 | 低风险 |
|-----|-------|-------|-------|
| 越界检查 | | | |
| 代码质量 | | | |
| 规范检查 | | | |
| 安全检查 | | | |
| 性能检查 | | | |
| 验收口径 | | | |
| **总计** | | | |
