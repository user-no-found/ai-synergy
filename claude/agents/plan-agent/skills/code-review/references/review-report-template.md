# 代码审核报告模板

```yaml
---
doc_type: review
plan_version: {plan_version}
review_at: {ISO8601}
status: passed | failed | passed_with_warnings
reviewer: Codex
---

# 代码审核报告

## 审核摘要

- **审核时间**：{ISO8601}
- **审核范围**：{N}个提案，{M}个文件
- **审核结论**：通过 / 不通过 / 有警告通过

### 问题统计

| 风险级别 | 数量 | 说明 |
|---------|------|------|
| 高 | {N} | 必须修复 |
| 中 | {N} | 建议修复 |
| 低 | {N} | 可选修复 |

## 审核范围

### 已审核提案

| proposal_id | 子代理 | 变更文件数 | 问题数 |
|-------------|-------|-----------|-------|
| {proposal_id_1} | python-agent | 5 | 2 |
| {proposal_id_2} | rust-agent | 3 | 0 |
| ... | ... | ... | ... |

### 已审核文件

| 文件路径 | 来源提案 | 操作 | 问题数 |
|---------|---------|------|-------|
| src/module_a/main.py | impl-module-a-python-agent | created | 1 |
| src/core/lib.rs | impl-core-rust-agent | created | 0 |
| ... | ... | ... | ... |

## 问题清单

### 高风险问题（必须修复）

#### 问题1：{问题标题}

- **文件**：{文件路径}
- **行号**：{行号}
- **类别**：{安全/越界/...}
- **描述**：{问题描述}
- **责任提案**：{proposal_id}
- **责任子代理**：{子代理名}
- **修复建议**：{修复建议}

```{语言}
// 问题代码
{问题代码片段}
```

#### 问题2：...

### 中风险问题（建议修复）

#### 问题1：{问题标题}

- **文件**：{文件路径}
- **行号**：{行号}
- **类别**：{代码质量/规范/...}
- **描述**：{问题描述}
- **责任提案**：{proposal_id}
- **责任子代理**：{子代理名}
- **修复建议**：{修复建议}

### 低风险问题（可选修复）

| 文件 | 行号 | 类别 | 描述 | 责任提案 |
|-----|------|------|------|---------|
| {文件} | {行号} | {类别} | {描述} | {proposal_id} |
| ... | ... | ... | ... | ... |

## 越界检查结果

- **检查结果**：通过 / 不通过

### 越界文件（如有）

| 文件路径 | 来源提案 | 越界类型 | 说明 |
|---------|---------|---------|------|
| {文件} | {proposal_id} | 超出allowed_paths | {说明} |
| {文件} | {proposal_id} | 命中forbidden_patterns | {说明} |

## 验收口径检查

### 各提案验收情况

#### {proposal_id_1}

- [x] {验收条件1} - 已满足
- [x] {验收条件2} - 已满足
- [ ] {验收条件3} - 未满足，原因：{原因}

#### {proposal_id_2}

- [x] {验收条件1} - 已满足
- [x] {验收条件2} - 已满足

## 审核结论

### 结论

{通过 / 不通过 / 有警告通过}

### 说明

{审核结论的详细说明}

### 用户确认选项

请选择：

1. **接受**：审核通过，进入发布流程
2. **部分接受**：列出保留项，其他问题需要修复
3. **强制通过**：记录风险自担，进入发布流程

### 修复指引（如有问题需要修复）

| 责任子代理 | 需修复问题数 | 涉及文件 |
|-----------|------------|---------|
| python-agent | 2 | src/module_a/main.py, src/module_a/utils.py |
| rust-agent | 1 | src/core/lib.rs |

**修复流程**：
1. 用户通知对应子代理修复问题
2. 子代理修复完成后通知用户
3. 用户通知 Codex 重新审核
```

---

## 审核通过时的简化报告

```yaml
---
doc_type: review
plan_version: {plan_version}
review_at: {ISO8601}
status: passed
reviewer: Codex
---

# 代码审核报告

## 审核摘要

- **审核时间**：{ISO8601}
- **审核范围**：{N}个提案，{M}个文件
- **审核结论**：✓ 通过

### 问题统计

| 风险级别 | 数量 |
|---------|------|
| 高 | 0 |
| 中 | 0 |
| 低 | {N} |

## 审核结论

代码审核通过，未发现高风险或中风险问题。

### 低风险问题（可选修复）

{如有低风险问题，列出表格}

### 用户确认选项

请选择：

1. **接受**：进入发布流程
2. **修复低风险问题后再发布**
```
