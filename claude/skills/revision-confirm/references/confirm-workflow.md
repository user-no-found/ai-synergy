# 修订确认工作流（revision-confirm）

## 0) 定位与读取（最小化）

1) 确认项目根目录
   - 默认项目根目录=当前会话所在目录
   - 不确定时必须先用`AskUserQuestion`询问用户确认

2) 定位草案文件
   - 目标文件：`Record/plan/draft-plan.md`
   - 如果不存在：用`AskUserQuestion`让用户确认路径

3) 最小读取策略
   - 重点读取"Codex修订意见"章节
   - 同时对照"Claude复审补充"章节（了解自己之前的分析）
   - 对照草案原文（需求摘要、scope、子代理分工等）

## 1) 分析Codex修订（必须完整分析，不能跳过）

对Codex修订意见中的每一项，Claude必须进行分析：

### 1.1 Codex认可的项
- 确认Codex是否正确理解了Claude的分析
- 确认草案是否已按认可内容更新
- 如有遗漏或理解偏差，标记为"需补充"

### 1.2 Codex不认可的项
- 分析Codex的不认可理由是否成立
- 如果理由成立：接受Codex的修正，标记为"接受修正"
- 如果理由不成立：说明异议理由，标记为"有异议"

### 1.3 Codex部分认可的项
- 分析认可部分是否正确处理
- 分析不认可部分的理由是否成立
- 分别标记处理结论

## 2) 判断是否可进入用户确认

### 2.1 存在异议（需要再次沟通）
- 列出所有异议项及理由
- 建议用户通知Codex再次修订
- **不得引导用户进入最终确认**

### 2.2 无异议但有补充（需要再次沟通）
- 列出需要补充的项
- 建议用户通知Codex补充修订
- **不得引导用户进入最终确认**

### 2.3 完全认可（可进入用户确认）
- 确认草案已完整更新
- 输出方案摘要供用户审阅
- 引导用户做最终三选一确认

## 3) 回写策略

- 把分析结论追加到`Record/plan/draft-plan.md`的"Claude确认意见"章节
- 明确标注当前状态：`可进入用户确认` / `需再次沟通`
